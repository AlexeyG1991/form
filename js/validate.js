products = [
	{ nc12: "859330910040", brand: "Whirlpool", model: "AWE 50510" },
	{ nc12: "859330861050", brand: "Whirlpool", model: "AWE 5080" },
	{ nc12: "859335610050", brand: "Whirlpool", model: "AWE 55141" },
	{ nc12: "859331110040", brand: "Whirlpool", model: "AWE 60410" },
	{ nc12: "859332910040", brand: "Whirlpool", model: "AWE 6080" },
	{ nc12: "859376210040", brand: "Whirlpool", model: "AWE 66710" },
	{ nc12: "869991567830", brand: "Whirlpool", model: "BI WDWG 75148 EU" },
	{ nc12: "869991559370", brand: "Whirlpool", model: "BI WMWG 71484E EU" },
	{ nc12: "859991632760", brand: "Whirlpool", model: "FFB 8248 BV UA" },
	{ nc12: "859991632770", brand: "Whirlpool", model: "FFD 9448 BV UA" },
	{ nc12: "859208910010", brand: "Whirlpool", model: "FSCR90420" },
	{ nc12: "859991567900", brand: "Whirlpool", model: "FWD71284SBEE" },
	{ nc12: "859991567890", brand: "Whirlpool", model: "FWD81284WCEE" },
	{ nc12: "859991579220", brand: "Whirlpool", model: "FWD91496BV EE" },
	{ nc12: "869991579750", brand: "Whirlpool", model: "FWDD1071681B EU" },
	{ nc12: "869991579730", brand: "Whirlpool", model: "FWDG86148B EU" },
	{ nc12: "869991579740", brand: "Whirlpool", model: "FWDG97168B EU" },
	{ nc12: "859991579410", brand: "Whirlpool", model: "FWG71283BV EE" },
	{ nc12: "859242010010", brand: "Whirlpool", model: "FWG81284W EU" },
	{ nc12: "859991579430", brand: "Whirlpool", model: "FWG81484BV EE" },
	{ nc12: "869991531540", brand: "Whirlpool", model: "FWSD71283WS EU" },
	{ nc12: "869991575880", brand: "Whirlpool", model: "FWSD81283BV EE" },
	{ nc12: "869991545750", brand: "Whirlpool", model: "FWSD81283WCV EU" },
	{ nc12: "869991057370", brand: "Whirlpool", model: "FWSF61053W EU" },
	{ nc12: "869991562060", brand: "Whirlpool", model: "FWSF61053W UA" },
	{ nc12: "869991530680", brand: "Whirlpool", model: "FWSF61253W EU" },
	{ nc12: "869991057380", brand: "Whirlpool", model: "FWSG61053W EU" },
	{ nc12: "869991598410", brand: "Whirlpool", model: "FWSG61053WV UA" },
	{ nc12: "869991566360", brand: "Whirlpool", model: "FWSG61083WBV UA" },
	{ nc12: "869991530710", brand: "Whirlpool", model: "FWSG61253W EU" },
	{ nc12: "869991575940", brand: "Whirlpool", model: "FWSG61283BV EE" },
	{ nc12: "869991566370", brand: "Whirlpool", model: "FWSG71283WBV UA" },
	{ nc12: "869991536740", brand: "Whirlpool", model: "FWSL61052W EU" },
	{ nc12: "869991536750", brand: "Whirlpool", model: "FWSL61252W EU" },
	{ nc12: "859334110050", brand: "Whirlpool", model: "TDLR 55111" },
	{ nc12: "859333810050", brand: "Whirlpool", model: "TDLR 60210" },
	{ nc12: "859333310050", brand: "Whirlpool", model: "TDLR 60230" },
	{ nc12: "859333210050", brand: "Whirlpool", model: "TDLR 65230" },
	{ nc12: "859991568680", brand: "Whirlpool", model: "TDLRS70210" },
	{ nc12: "859991568670", brand: "Whirlpool", model: "TDLRS70231" },
	{ nc12: "859991632520", brand: "Whirlpool", model: "AWE 6080 UA" },
	{ nc12: "859991631410", brand: "Whirlpool", model: "AWE 55141 UA" },
	{ nc12: "859991636380", brand: "Whirlpool", model: "TDLR 55020S UA" },
	{ nc12: "859991581330", brand: "Indesit", model: "BTW A51052 (UA)" },
	{ nc12: "859991536870", brand: "Indesit", model: "BTW A61053 (EU)" },
	{ nc12: "859991536890", brand: "Indesit", model: "BTW D51052 (EU)" },
	{ nc12: "859991535070", brand: "Indesit", model: "BTW D61053 (EU)" },
	{ nc12: "859991535050", brand: "Indesit", model: "BTW D61253 (EU)" },
	{ nc12: "859991536900", brand: "Indesit", model: "BTW E71253P (EU)" },
	{ nc12: "869991561950", brand: "Indesit", model: "BWSA 51052 W EU" },
	{ nc12: "869991034720", brand: "Indesit", model: "BWSA 61052 W UA" },
	{ nc12: "869991034740", brand: "Indesit", model: "BWSA 61053 W EU" },
	{ nc12: "869991031170", brand: "Indesit", model: "BWSA 61253 W EU" },
	{ nc12: "869991034760", brand: "Indesit", model: "BWSA 71052 W EU" },
	{ nc12: "869991547430", brand: "Indesit", model: "BWSA 71253 W EU" },
	{ nc12: "869991587680", brand: "Indesit", model: "BWSE 61052 W UA" },
	{ nc12: "869991587700", brand: "Indesit", model: "BWSE 61252 WK UA" },
	{ nc12: "869991587690", brand: "Indesit", model: "BWSE 71052 W UA" },
	{ nc12: "869991017080", brand: "Indesit", model: "E2SB 2160B B UA" },
	{ nc12: "869990957200", brand: "Indesit", model: "E2SC 2150 W UA" },
	{ nc12: "869991017090", brand: "Indesit", model: "E2SC 2160 W UA" },
	{ nc12: "869990931290", brand: "Indesit", model: "E2SD 1160C B UA" },
	{ nc12: "869991017100", brand: "Indesit", model: "E2SD 2160A B UA" },
	{ nc12: "869990936750", brand: "Indesit", model: "E2SD 2270A UA" },
	{ nc12: "869990957210", brand: "Indesit", model: "E2SE 2150 W UA" },
	{ nc12: "869991016480", brand: "Indesit", model: "E2SE 2160 W UA" },
	{ nc12: "869990888290", brand: "Indesit", model: "EWDE 71280 W EU" },
	{ nc12: "869990856750", brand: "Indesit", model: "IWSB 50851 UA" },
	{ nc12: "869990856740", brand: "Indesit", model: "IWSB 51051 UA" },
	{ nc12: "869990848280", brand: "Indesit", model: "IWSB 61051 C ECO EU" },
	{ nc12: "869990856780", brand: "Indesit", model: "IWSC 51051 UA" },
	{ nc12: "869990957190", brand: "Indesit", model: "IWSC 51052A UA" },
	{ nc12: "869990856770", brand: "Indesit", model: "IWSD 51051 UA" },
	{ nc12: "869991596860", brand: "Indesit", model: "OMTWE 71252 S EU" },
	{ nc12: "869991597330", brand: "Indesit", model: "OMTWE 71483 W EU" },
	{ nc12: "869991597310", brand: "Indesit", model: "OMTWE 81283 WK EU" },
	{ nc12: "869991596890", brand: "Indesit", model: "OMTWSA 51052 W EU" },
	{ nc12: "869991588210", brand: "Indesit", model: "OMTWSA 61052 W UA" },
	{ nc12: "869991588170", brand: "Indesit", model: "OMTWSA 61053 WK EU" },
	{ nc12: "869991588310", brand: "Indesit", model: "OMTWSE 61051 WK EU" },
	{ nc12: "869991588240", brand: "Indesit", model: "OMTWSE 61051 WK UA" },
	{ nc12: "869991596910", brand: "Indesit", model: "OMTWSE 61252 W EU" },
	{ nc12: "869990888270", brand: "Indesit", model: "XWDE 1071481XWKKK EU" },
	{ nc12: "869991630910", brand: "Indesit", model: "E2SD 2160A B EU" },
	{ nc12: "869991630800", brand: "Indesit", model: "E2SC 2150 W UA" },
	{ nc12: "869991630680", brand: "Indesit", model: "E2SC 2160 W UA" },
	{ nc12: "869991630850", brand: "Indesit", model: "E2SE 2150 W UA" },
	{ nc12: "869991630880", brand: "Indesit", model: "E2SE 2160 W UA" },
	{ nc12: "869991632120", brand: "Indesit", model: "EWDE 71280 W EU" },
	{ nc12: "869991630870", brand: "Indesit", model: "IWSB 50851 UA" },
	{ nc12: "869991630810", brand: "Indesit", model: "IWSB 51051 UA" },
	{ nc12: "869991630830", brand: "Indesit", model: "IWSC 51052A UA" },
	{ nc12: "869991630820", brand: "Indesit", model: "IWSD 51051 UA" },
];
const models = [
	"AWE 50510",
	"AWE 5080",
	"AWE 55141",
	"AWE 60410",
	"AWE 6080",
	"AWE 66710",
	"BI WDWG 75148 EU",
	"BI WMWG 71484E EU",
	"FFB 8248 BV UA",
	"FFD 9448 BV UA",
	"FSCR90420",
	"FWD71284SBEE",
	"FWD81284WCEE",
	"FWD91496BV EE",
	"FWDD1071681B EU",
	"FWDG86148B EU",
	"FWDG97168B EU",
	"FWG71283BV EE",
	"FWG81284W EU",
	"FWG81484BV EE",
	"FWSD71283WS EU",
	"FWSD81283BV EE",
	"FWSD81283WCV EU",
	"FWSF61053W EU",
	"FWSF61053W UA",
	"FWSF61253W EU",
	"FWSG61053W EU",
	"FWSG61053WV UA",
	"FWSG61083WBV UA",
	"FWSG61253W EU",
	"FWSG61283BV EE",
	"FWSG71283WBV UA",
	"FWSL61052W EU",
	"FWSL61252W EU",
	"TDLR 55111",
	"TDLR 60210",
	"TDLR 60230",
	"TDLR 65230",
	"TDLRS70210",
	"TDLRS70231",
	"AWE 6080 UA",
	"AWE 55141 UA",
	"TDLR 55020S UA",
	"BTW A51052 (UA)",
	"BTW A61053 (EU)",
	"BTW D51052 (EU)",
	"BTW D61053 (EU)",
	"BTW D61253 (EU)",
	"BTW E71253P (EU)",
	"BWSA 51052 W EU",
	"BWSA 61052 W UA",
	"BWSA 61053 W EU",
	"BWSA 61253 W EU",
	"BWSA 71052 W EU",
	"BWSA 71253 W EU",
	"BWSE 61052 W UA",
	"BWSE 61252 WK UA",
	"BWSE 71052 W UA",
	"E2SB 2160B B UA",
	"E2SC 2150 W UA",
	"E2SC 2160 W UA",
	"E2SD 1160C B UA",
	"E2SD 2160A B UA",
	"E2SD 2270A UA",
	"E2SE 2150 W UA",
	"E2SE 2160 W UA",
	"EWDE 71280 W EU",
	"IWSB 50851 UA",
	"IWSB 51051 UA",
	"IWSB 61051 C ECO EU",
	"IWSC 51051 UA",
	"IWSC 51052A UA",
	"IWSD 51051 UA",
	"OMTWE 71252 S EU",
	"OMTWE 71483 W EU",
	"OMTWE 81283 WK EU",
	"OMTWSA 51052 W EU",
	"OMTWSA 61052 W UA",
	"OMTWSA 61053 WK EU",
	"OMTWSE 61051 WK EU",
	"OMTWSE 61051 WK UA",
	"OMTWSE 61252 W EU",
	"XWDE 1071481XWKKK EU",
	"E2SD 2160A B EU",
	"E2SC 2150 W UA",
	"E2SC 2160 W UA",
	"E2SE 2150 W UA",
	"E2SE 2160 W UA",
	"EWDE 71280 W EU",
	"IWSB 50851 UA",
	"IWSB 51051 UA",
	"IWSC 51052A UA",
	"IWSD 51051 UA",
];
const nc12 = [
	"859330910040",
	"859330861050",
	"859335610050",
	"859331110040",
	"859332910040",
	"859376210040",
	"869991567830",
	"869991559370",
	"859991632760",
	"859991632770",
	"859208910010",
	"859991567900",
	"859991567890",
	"859991579220",
	"869991579750",
	"869991579730",
	"869991579740",
	"859991579410",
	"859242010010",
	"859991579430",
	"869991531540",
	"869991575880",
	"869991545750",
	"869991057370",
	"869991562060",
	"869991530680",
	"869991057380",
	"869991598410",
	"869991566360",
	"869991530710",
	"869991575940",
	"869991566370",
	"869991536740",
	"869991536750",
	"859334110050",
	"859333810050",
	"859333310050",
	"859333210050",
	"859991568680",
	"859991568670",
	"859991632520",
	"859991631410",
	"859991636380",
	"859991581330",
	"859991536870",
	"859991536890",
	"859991535070",
	"859991535050",
	"859991536900",
	"869991561950",
	"869991034720",
	"869991034740",
	"869991031170",
	"869991034760",
	"869991547430",
	"869991587680",
	"869991587700",
	"869991587690",
	"869991017080",
	"869990957200",
	"869991017090",
	"869990931290",
	"869991017100",
	"869990936750",
	"869990957210",
	"869991016480",
	"869990888290",
	"869990856750",
	"869990856740",
	"869990848280",
	"869990856780",
	"869990957190",
	"869990856770",
	"869991596860",
	"869991597330",
	"869991597310",
	"869991596890",
	"869991588210",
	"869991588170",
	"869991588310",
	"869991588240",
	"869991596910",
	"869990888270",
	"869991630910",
	"869991630800",
	"869991630680",
	"869991630850",
	"869991630880",
	"869991632120",
	"869991630870",
	"869991630810",
	"869991630830",
	"869991630820",
];
areas = [
	"Вінницька область",
	"Волинська область",
	"Дніпропетровська область",
	"Житомирська область",
	"Закарпатська область",
	"Запорізька область",
	"Івано-Франківська область",
	"Київська область",
	"Кіровоградська область",
	"Львівська область",
	"Миколаївська область",
	"Одеська область",
	"Полтавська область",
	"Рівненська область",
	"Cумська область",
	"Тернопільська область",
	"Харківська область",
	"Херсонська область",
	"Хмельницька область",
	"Черкаська область",
	"Чернівецька область",
	"Чернігівська область",
	"м. Київ",
];

const mainForm = document.forms["register_form"];
// mainForm.brand.addEventListener("change", (e) => {
// 	fillOptions(products.filter(e => e.brand ===mainForm.brand.value).map(e=>e.model),mainForm.modelname)
// });

const fillOptions = (options, target) => {
	options.forEach((e) => {
		const option = document.createElement("option");
		option.value = e;
		option.innerText = e;
		target.appendChild(option);
	});
};
fillOptions(areas, mainForm.area);
fillOptions(models, mainForm.modelname);

const validateRequired = (input, min = 0, max = 256) => {
	if (!input.value) return input;
	const len = input.value.length;
	if (len < min || len > max) return input;
	return false;
};
const validateEmail = (input) => {
	const re =
		/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

	if (!re.test(String(input.value).toLowerCase())) return input;
	return false;
};
const validatePhone = (input) => {
	const value = input.value;
	if (value.length !== 10 || !value.match("^[0-9]{10}")) return input;
	return false;
};
const validateRepeat = (input, value) => {
	if (input.value !== value) return input;
	return false;
};
const validateDate = (input) => {
	if (!input.value) return input;
	const diff = getDifferenceInDays(new Date(input.value), new Date());

	return diff < 14 ? input : false;
};
function getDifferenceInDays(date1, date2) {
	const diffInMs = date2 - date1;
	return diffInMs / (1000 * 60 * 60 * 24);
}
mainForm.brand.addEventListener("select", () => console.log());
const validateAgree = () => {
	if (
		(mainForm["radio-1"].checked || mainForm["radio-2"].checked) &&
		(mainForm["radio-3"].checked || mainForm["radio-4"].checked)
	) {
		mainForm.instrument.nextElementSibling.classList.remove("disabled");
		mainForm.brand.nextElementSibling.classList.remove("disabled");
		mainForm.modelname.nextElementSibling.classList.remove("disabled");
		mainForm.shopname.nextElementSibling.classList.remove("disabled");
		mainForm.serialnumber.disabled = false;
		mainForm.purchasedate.disabled = false;
		mainForm.fiscalCheck.disabled = false;
		mainForm.shopname.disabled = false;
		mainForm.photodownload.disabled = false;
		if (mainForm.cost) mainForm.cost.disabled = false;
		if (mainForm.photodownload2) mainForm.photodownload2.disabled = false;
	} else {
		mainForm.instrument.nextElementSibling.classList.add("disabled");
		mainForm.brand.nextElementSibling.classList.add("disabled");
		mainForm.modelname.nextElementSibling.classList.add("disabled");
		mainForm.shopname.nextElementSibling.classList.add("disabled");
		mainForm.serialnumber.disabled = true;
		mainForm.purchasedate.disabled = true;
		mainForm.fiscalCheck.disabled = true;
		mainForm.shopname.disabled = true;
		mainForm.photodownload.disabled = true;
		if (mainForm.photodownload2) mainForm.photodownload2.disabled = true;
		if (mainForm.cost) mainForm.cost.disabled = true;
	}
};
mainForm["radio-1"].addEventListener("change", validateAgree);
mainForm["radio-2"].addEventListener("change", validateAgree);
mainForm["radio-3"].addEventListener("change", validateAgree);
mainForm["radio-4"].addEventListener("change", validateAgree);

const validate = (form) => {
	const invalid = [];
	if (validateRequired(form.firstname, 2, 40)) invalid.push(form.firstname);
	if (validateRequired(form.lastname, 2, 40)) invalid.push(form.lastname);
	if (validatePhone(form.userphone)) invalid.push(form.userphone);
	if (validateRepeat(form.userphonerepeat, form.userphone.value))
		invalid.push(form.userphonerepeat);
	if (validateEmail(form.useremail)) invalid.push(form.useremail);
	if (validateRepeat(form.emailrepeat, form.useremail.value))
		invalid.push(form.emailrepeat);
	if (validateRequired(form.area)) invalid.push(form.area);
	if (validateRequired(form.city, 2, 40)) invalid.push(form.city);
	if (validateRequired(form.index, 2, 40)) invalid.push(form.index);
	if (validateRequired(form.instrument)) invalid.push(form.instrument);
	if (validateRequired(form.brand)) invalid.push(form.brand);
	if (validateRequired(form.modelname, 2, 40)) invalid.push(form.modelname);
	if (validateRequired(form.nc12, 2, 40)) invalid.push(form.nc12);
	if (validateDate(form.purchasedate)) invalid.push(form.purchasedate);
	if (validateRequired(form.fiscalCheck, 2, 40)) invalid.push(form.fiscalCheck);
	if (validateRequired(form.shopname)) invalid.push(form.shopname);
	if (validateRequired(form.serialnumber, 10, 40))
		invalid.push(form.serialnumber);
	if (validateRequired(form.photodownload, 2, 256))
		invalid.push(form.photodownload);

	if (mainForm.cost) {
		if (validateRequired(form.cost, 1, 20)) invalid.push(form.cost);
	}
	if (mainForm.photodownload2) {
		if (validateRequired(form.photodownload2, 2, 256))
			invalid.push(form.photodownload2);
	}
	console.log(invalid);
	invalid.forEach((e) => {
		e.classList.add("danger");
	});
	return !invalid.length;
};

const submit = document.getElementById("mainsubmitbutton");
submit.addEventListener("click", (e) => {
	e.preventDefault();
	Array.from(mainForm.elements).forEach((e) => {
		e.classList.remove("danger");
	});
	if (validate(mainForm)) {
		const formData = new FormData(mainForm);

		$.ajax({
			url: "/send-mail.php",
			type: "POST",
			async: true,
			processData: false,
			contentType: false,
			data: formData,
			success: function (data) {
				console.log("ok");
			},
			error: function (data) {
				console.log("bad");
			},
		});
	}
});
